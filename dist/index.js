Object.defineProperty(exports,"__esModule",{value:!0});var reactIdleTimer=require("react-idle-timer"),react=require("react");function __awaiter(e,o,c,u){return new(c=c||Promise)(function(t,n){function r(e){try{i(u.next(e))}catch(e){n(e)}}function a(e){try{i(u.throw(e))}catch(e){n(e)}}function i(e){var n;e.done?t(e.value):((n=e.value)instanceof c?n:new c(function(e){e(n)})).then(r,a)}i((u=u.apply(e,o||[])).next())})}function __generator(r,a){var i,o,c,u={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(t){return function(e){var n=[t,e];if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(c=2&n[0]?o.return:n[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,n[1])).done)return c;switch(o=0,(n=c?[2&n[0],c.value]:n)[0]){case 0:case 1:c=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(c=0<(c=u.trys).length&&c[c.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!c||n[1]>c[0]&&n[1]<c[3])){u.label=n[1];break}if(6===n[0]&&u.label<c[1]){u.label=c[1],c=n;break}if(c&&u.label<c[2]){u.label=c[2],u.ops.push(n);break}c[2]&&u.ops.pop(),u.trys.pop();continue}n=a.call(r,u)}catch(e){n=[6,e],o=0}finally{i=c=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}}var MARGIN=300,imageToHtml=function(e,n,t){var r=document.createElement("img");return r.src=e.src,r.alt=e.alt,r.classList.add("screensaver-image"),r.style.left="".concat(Math.random()*window.innerWidth,"px"),r.style.top="".concat(Math.random()*(window.innerHeight-MARGIN),"px"),r.style.width="".concat(300*Math.random()+200,"px"),setTimeout(function(){r.classList.add("animated"),r.classList.add("fade-in-up")},n*t),r},imagesToHtml=function(e,t){return e.map(function(e,n){return imageToHtml(e,n,t)})},ANIMATION_DURATION=1,generateScreensaverHtml=function(e,n){var e=imagesToHtml(e,n),t=document.createElement("div");return t.id="arena-screensaver-background",t.classList.add("screensaver-background"),t.classList.add("animated"),t.classList.add("fade-in"),e.forEach(function(e){return t.appendChild(e)}),t},generateStylesHtml=function(){var e=document.createElement("style"),n="\n      .screensaver-image {\n          position: fixed;\n          opacity: 0;\n          border-radius: 10px;\n      }\n      .screensaver-background {\n          position: fixed; \n          left: 0; \n          top: 0; \n          width: 100%; \n          height: 100%;\n          background-color: rgba(0,0,0,0.4);\n      }\n      @keyframes fade-in {\n          from {}\n          to {\n              opacity: 1;\n          }\n      }\n      @-webkit-keyframes fade-in {\n          from {}\n          to {\n              opacity: 1;\n          }\n      }\n      @keyframes fade-out {\n          from {}\n          to {\n              opacity: 0;\n          }\n      }\n      @-webkit-keyframes fade-out {\n          from {}\n          to {\n              opacity: 0;\n          }\n      }\n      @keyframes fade-in-up {\n          from {\n              transform: translate3d(0,40px,0);\n              opacity: 0;\n          }\n          to {\n              transform: translate3d(0,0,0);\n              opacity: 1\n          }\n      }\n      @-webkit-keyframes fade-in-up {\n          from {\n              transform: translate3d(0,40px,0);\n              opacity: 0;\n          }\n          to {\n              transform: translate3d(0,0,0);\n              opacity: 1;\n          }\n      }\n      .animated {\n          animation-duration: ".concat(ANIMATION_DURATION,"s;\n          animation-fill-mode: both;\n          -webkit-animation-duration: 1s;\n          -webkit-animation-fill-mode: both\n      }\n      \n      .fade-in-up {\n          opacity: 0;\n          animation-name: fade-in-up;\n          -webkit-animation-name: fade-in-up;\n      }\n      .fade-in {\n          opacity: 0;\n          animation-name: fade-in;\n          -webkit-animation-name: fade-in;\n      }\n      .fade-out {\n          opacity: 1;\n          animation-name: fade-out;\n          -webkit-animation-name: fade-out;\n      }\n      ");return e.innerText=n,e},formatImage=function(e){return null===e.source?{id:e.id,alt:e.description,src:e.image.display.url}:{id:e.id,alt:e.description,src:e.source.url}},formatImageArray=function(e){return e.map(formatImage)},getChannel=function(t){return __awaiter(void 0,void 0,void 0,function(){var n;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,fetch("https://api.are.na/v2/channels/".concat(t,"?per=50"))];case 1:return[4,e.sent().json()];case 2:return n=e.sent(),n=n.contents,n=n.filter(function(e){return"Image"===e.class}),[2,formatImageArray(n)];case 3:return n=e.sent(),console.error(n),[3,4];case 4:return[2]}})})},useArenaScreensaver=function(e){var t=e.arenaSlug,n=e.timeout,n=void 0===n?12e4:n,e=e.timeBetween,r=void 0===e?2e3:e;if(!t)throw new Error("arenaSlug is required");var a=react.useRef(null),i=react.useRef(null),o=react.useRef(null),c=react.useCallback(function(){setTimeout(function(){var e;null!==o.current&&(null===a.current&&(e=generateStylesHtml(),document.head.appendChild(e),a.current=e),null===i.current&&(e=generateScreensaverHtml(o.current,r),i.current=e,document.body.appendChild(e)))},1e3*ANIMATION_DURATION)},[i,o,r]),e=react.useCallback(function(){return __awaiter(void 0,void 0,void 0,function(){var n;return __generator(this,function(e){switch(e.label){case 0:return null!==o.current?[3,2]:[4,getChannel(t)];case 1:(n=e.sent())&&(o.current=n),e.label=2;case 2:return c(),[2]}})})},[o,c,t]),u=react.useCallback(function(){null!==i.current&&(i.current.classList.remove("fade-in"),i.current.classList.add("fade-out")),setTimeout(function(){i.current&&(i.current.remove(),i.current=null),a.current&&(a.current.remove(),a.current=null)},1e3*ANIMATION_DURATION)},[i]),s=react.useCallback(function(){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u()];case 1:return e.sent(),[2]}})})},[u]);return reactIdleTimer.useIdleTimer({onIdle:e,onActive:s,timeout:n})};exports.useArenaScreensaver=useArenaScreensaver;
//# sourceMappingURL=index.js.map
